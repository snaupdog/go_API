<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fitness Data</title>
  </head>
  <body>
    <h1>Fitness Data</h1>

    <form id="addDataForm">
      <label for="date">Date:</label>
      <input
        type="date"
        id="date"
        name="date"
        placeholder="YYYY-MM-DD"
        required
      /><br /><br />
      <label for="heartRate">heartRate:</label>
      <input
        type="number"
        id="heartRate"
        name="heartRate"
        required
      /><br /><br />
      <label for="stepCount">Step Count:</label>
      <input
        type="number"
        id="stepCount"
        name="stepCount"
        required
      /><br /><br />
      <button type="submit">Add Data</button>
    </form>

    <h2>Fitness Data:</h2>
    <ul id="fitnessData"></ul>

<script>
    document.getElementById('addDataForm').addEventListener('submit', function(event) {
        event.preventDefault();
        const formData = new FormData(event.target);
        const data = {
            date: formData.get('date'),
            heart_rate: parseInt(formData.get('heartRate')),
            step_count: parseInt(formData.get('stepCount'))
        };

        fetch('http://localhost:8080/data', { // Updated endpoint URL
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(newData => {
            console.log('New data added:', newData);
            // Clear form fields
            event.target.reset();
            // Refresh the fitness data list
            refreshFitnessDataList();
        })
        .catch(error => console.error('Error adding data:', error));
    });

    function refreshFitnessDataList() {
        fetch('http://localhost:8080/data', { // Updated endpoint URL
            method: 'GET',
        })
        .then(response => response.json())
        .then(data => {
            const fitnessDataList = document.getElementById('fitnessData');
            fitnessDataList.innerHTML = ''; // Clear previous data
            data.forEach(item => {
                const listItem = document.createElement('li');
                    listItem.textContent = `Date: ${item.date}, heart rate: ${item.heart_rate},Step Count: ${item.step_count}`;
                fitnessDataList.appendChild(listItem);
            });
        })
        .catch(error => console.error('Error fetching data:', error));
    }

    // Initial data load
    refreshFitnessDataList();
</script>
    </script>
  </body>
</html>
